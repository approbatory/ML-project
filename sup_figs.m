%either used or unused supplementary figures

%unused: effect of cutoff velocity on amount of
%trials declared:

while true
    sessions = {...
        '../linear_track/Mouse2025/Mouse-2025-20150307-linear-track/Mouse-2025-20150307_104428-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150228-linear-track/Mouse-2025-20150228_160317-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150321-linear-track/Mouse-2025-20150321_134149-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150323-linear-track/Mouse-2025-20150323_090111-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150325-linear-track/Mouse-2025-20150325_131626-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150303-linear-track/Mouse-2025-20150303_091715-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150305-linear-track/Mouse-2025-20150305_112222-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150317-linear-track/Mouse-2025-20150317_090833-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150327-linear-track/Mouse-2025-20150327_094347-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150301-linear-track/Mouse-2025-20150301_130341-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150301-linear-track/Mouse-2025-20150301_181458-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150329-linear-track/Mouse-2025-20150329_111804-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150319-linear-track/Mouse-2025-20150319_090510-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150319-linear-track/Mouse-2025-20150319_095211-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150331-linear-track/Mouse-2025-20150331_082446-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150313-linear-track/Mouse-2025-20150313_103035-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150315-linear-track/Mouse-2025-20150315_094432-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150309-linear-track/Mouse-2025-20150309_095611-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2025/Mouse-2025-20150311-linear-track/Mouse-2025-20150311_081758-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150126-linear-track/Mouse-2012-20150126_083013-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150209-linear-track/Mouse-2012-20150209_084856-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141203-linear-track/Mouse-2012-20141203_084234-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150202-linear-track/Mouse-2012-20150202_085844-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141219-linear-track/Mouse-2012-20141219_094111-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141129-linear-track/Mouse-2012-20141129_100639-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150118-linear-track/Mouse-2012-20150118_100831-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150118-linear-track/Mouse-2012-20150118_122056-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150212-linear-track/Mouse-2012-20150212_082737-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150205-linear-track/Mouse-2012-20150205_090558-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141209-linear-track/Mouse-2012-20141209_082401-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141213-linear-track/Mouse-2012-20141213_100118-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150130-linear-track/Mouse-2012-20150130_102501-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150203-linear-track/Mouse-2012-20150203_091636-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141221-linear-track/Mouse-2012-20141221_095806-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150211-linear-track/Mouse-2012-20150211_151241-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141207-linear-track/Mouse-2012-20141207_100218-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141126-linear-track/Mouse-2012-20141126_085441-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141205-linear-track/Mouse-2012-20141205_083324-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150120-linear-track/Mouse-2012-20150120_083419-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141123-linear-track/Mouse-2012-20141123_000520-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150116-linear-track/Mouse-2012-20150116_101239-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150124-linear-track/Mouse-2012-20150124_100435-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150207-linear-track/Mouse-2012-20150207_102450-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150207-linear-track/Mouse-2012-20150207_134254-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141223-linear-track/Mouse-2012-20141223_082741-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150122-linear-track/Mouse-2012-20150122_082416-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141127-linear-track/Mouse-2012-20141127_101659-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150128-linear-track/Mouse-2012-20150128_100143-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150128-linear-track/Mouse-2012-20150128_171615-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150114-linear-track/Mouse-2012-20150114_140933-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150112-linear-track/Mouse-2012-20150112_085723-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141211-linear-track/Mouse-2012-20141211_121707-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150123-linear-track/Mouse-2012-20150123_135330-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150201-linear-track/Mouse-2012-20150201_095905-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20150113-linear-track/Mouse-2012-20150113_141832-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141217-linear-track/Mouse-2012-20141217_104915-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141125-linear-track/Mouse-2012-20141125_215941-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141125-linear-track/Mouse-2012-20141125_030700-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141215-linear-track/Mouse-2012-20141215_110325-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2012/Mouse-2012-20141201-linear-track/Mouse-2012-20141201_083556-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150205-linear-track/Mouse-2010-20150205_102524-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141128-linear-track/Mouse-2010-20141128_121404-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150202-linear-track/Mouse-2010-20150202_101928-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141207-linear-track/Mouse-2010-20141207_115722-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141219-linear-track/Mouse-2010-20141219_105955-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150116-linear-track/Mouse-2010-20150116_113236-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150114-linear-track/Mouse-2010-20150114_152716-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141213-linear-track/Mouse-2010-20141213_115553-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150118-linear-track/Mouse-2010-20150118_134034-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150118-linear-track/Mouse-2010-20150118_112236-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150207-linear-track/Mouse-2010-20150207_114314-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150130-linear-track/Mouse-2010-20150130_094711-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141209-linear-track/Mouse-2010-20141209_101632-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150126-linear-track/Mouse-2010-20150126_094735-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141202-linear-track/Mouse-2010-20141202_110542-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141223-linear-track/Mouse-2010-20141223_094533-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150120-linear-track/Mouse-2010-20150120_095710-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150113-linear-track/Mouse-2010-20150113_160417-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141221-linear-track/Mouse-2010-20141221_113118&115136-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141126-linear-track/Mouse-2010-20141126_151543-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141126-linear-track/Mouse-2010-20141126_111415-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150122-linear-track/Mouse-2010-20150122_093836-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141125-linear-track/Mouse-2010-20141125_000156-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150123-linear-track/Mouse-2010-20150123_150954-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150212-linear-track/Mouse-2010-20150212_094703-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150203-linear-track/Mouse-2010-20150203_103253-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150201-linear-track/Mouse-2010-20150201_111454-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141211-linear-track/Mouse-2010-20141211_140916-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150211-linear-track/Mouse-2010-20150211_160238-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141205-linear-track/Mouse-2010-20141205_102648-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150112-linear-track/Mouse-2010-20150112_103135-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141130-linear-track/Mouse-2010-20141130_115330-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150209-linear-track/Mouse-2010-20150209_100711-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141203-linear-track/Mouse-2010-20141203_103645-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141215-linear-track/Mouse-2010-20141215_125115-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150124-linear-track/Mouse-2010-20150124_111828-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20141217-linear-track/Mouse-2010-20141217_120259-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2010/Mouse-2010-20150128-linear-track/Mouse-2010-20150128_111752-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150317-linear-track/Mouse-2028-20150317_102240-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150325-linear-track/Mouse-2028-20150325_143248-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150303-linear-track/Mouse-2028-20150303_103622-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150305-linear-track/Mouse-2028-20150305_132231-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150311-linear-track/Mouse-2028-20150311_093214-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150313-linear-track/Mouse-2028-20150313_114415-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150319-linear-track/Mouse-2028-20150319_105610-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150323-linear-track/Mouse-2028-20150323_105955-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150329-linear-track/Mouse-2028-20150329_133137-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150307-linear-track/Mouse-2028-20150307_120240-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150309-linear-track/Mouse-2028-20150309_110935-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150321-linear-track/Mouse-2028-20150321_144549-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150301-linear-track/Mouse-2028-20150301_141039-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150301-linear-track/Mouse-2028-20150301_192709-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150228-linear-track/Mouse-2028-20150228_114834-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150228-linear-track/Mouse-2028-20150228_172215-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150327-linear-track/Mouse-2028-20150327_105544-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2028/Mouse-2028-20150315-linear-track/Mouse-2028-20150315_105814-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150301-linear-track/Mouse-2019-20150301_104001-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150301-linear-track/Mouse-2019-20150301_143437-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150311-linear-track/Mouse-2019-20150311_101049-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150321-linear-track/Mouse-2019-20150321_095525-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150228-linear-track/Mouse-2019-20150228_130909-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150228-linear-track/Mouse-2019-20150228_174527-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150326-linear-track/Mouse-2019-20150326_081710-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150306-linear-track/Mouse-2019-20150306_093422-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150331-linear-track/Mouse-2019-20150331_125138-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2019/Mouse-2019-20150316-linear-track/Mouse-2019-20150316_072301-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150130-linear-track/Mouse-2011-20150130_091036-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141209-linear-track/Mouse-2011-20141209_090137-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141223-linear-track/Mouse-2011-20141223_090517-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150116-linear-track/Mouse-2011-20150116_105412-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141211-linear-track/Mouse-2011-20141211_125424-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150112-linear-track/Mouse-2011-20150112_094026-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150124-linear-track/Mouse-2011-20150124_104148-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141201-linear-track/Mouse-2011-20141201_091423-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141126-linear-track/Mouse-2011-20141126_142057-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141126-linear-track/Mouse-2011-20141126_102932-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141127-linear-track/Mouse-2011-20141127_105556-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141125-linear-track/Mouse-2011-20141125_223115-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141125-linear-track/Mouse-2011-20141125_033559-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141217-linear-track/Mouse-2011-20141217_112712-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150122-linear-track/Mouse-2011-20150122_090159-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150128-linear-track/Mouse-2011-20150128_175300-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150128-linear-track/Mouse-2011-20150128_103926-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141129-linear-track/Mouse-2011-20141129_104511-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141123-linear-track/Mouse-2011-20141123_003522-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141203-linear-track/Mouse-2011-20141203_092044-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141221-linear-track/Mouse-2011-20141221_103622-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150205-linear-track/Mouse-2011-20150205_094701-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150207-linear-track/Mouse-2011-20150207_110324-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150207-linear-track/Mouse-2011-20150207_142436-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150209-linear-track/Mouse-2011-20150209_092502-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141213-linear-track/Mouse-2011-20141213_104253-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141207-linear-track/Mouse-2011-20141207_104116-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150113-linear-track/Mouse-2011-20150113_150037-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150203-linear-track/Mouse-2011-20150203_095456-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150120-linear-track/Mouse-2011-20150120_091222-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150126-linear-track/Mouse-2011-20150126_091016-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141219-linear-track/Mouse-2011-20141219_102235-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150118-linear-track/Mouse-2011-20150118_104559-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20141215-linear-track/Mouse-2011-20141215_113956-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150212-linear-track/Mouse-2011-20150212_090836-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2011/Mouse-2011-20150211-linear-track/Mouse-2011-20150211_163711-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150306-linear-track/Mouse-2029-20150306_121634-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150321-linear-track/Mouse-2029-20150321_122709-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150228-linear-track/Mouse-2029-20150228_150949-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150228-linear-track/Mouse-2029-20150228_120509-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150331-linear-track/Mouse-2029-20150331_152034-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150326-linear-track/Mouse-2029-20150326_105003-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150316-linear-track/Mouse-2029-20150316_094956-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150311-linear-track/Mouse-2029-20150311_131945-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150301-linear-track/Mouse-2029-20150301_121435-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2029/Mouse-2029-20150301-linear-track/Mouse-2029-20150301_165938-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150321-linear-track/Mouse-2024-20150321_130536&130559-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150311-linear-track/Mouse-2024-20150311_073912-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150305-linear-track/Mouse-2024-20150305_104454-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150329-linear-track/Mouse-2024-20150329_104048-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150228-linear-track/Mouse-2024-20150228_153237-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150313-linear-track/Mouse-2024-20150313_095203-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150301-linear-track/Mouse-2024-20150301_173817-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150301-linear-track/Mouse-2024-20150301_124134-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150317-linear-track/Mouse-2024-20150317_202708-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150315-linear-track/Mouse-2024-20150315_090450-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150323-linear-track/Mouse-2024-20150323_082351-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150325-linear-track/Mouse-2024-20150325_114324-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150331-linear-track/Mouse-2024-20150331_101607-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150319-linear-track/Mouse-2024-20150319_082641-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150309-linear-track/Mouse-2024-20150309_090858&091446-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150327-linear-track/Mouse-2024-20150327_090539-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150303-linear-track/Mouse-2024-20150303_082851-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2024/Mouse-2024-20150307-linear-track/Mouse-2024-20150307_100459-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150311-linear-track/Mouse-2021-20150311_104705-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150306-linear-track/Mouse-2021-20150306_101057-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150316-linear-track/Mouse-2021-20150316_075956-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150228-linear-track/Mouse-2021-20150228_180537-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150331-linear-track/Mouse-2021-20150331_132808-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150301-linear-track/Mouse-2021-20150301_151117-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150301-linear-track/Mouse-2021-20150301_110509-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2021/Mouse-2021-20150326-linear-track/Mouse-2021-20150326_085536-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150311-linear-track/Mouse-2023-20150311_124240-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150321-linear-track/Mouse-2023-20150321_114832-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150331-linear-track/Mouse-2023-20150331_144419-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150301-linear-track/Mouse-2023-20150301_114752-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150301-linear-track/Mouse-2023-20150301_162349-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150228-linear-track/Mouse-2023-20150228_144258-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150228-linear-track/Mouse-2023-20150228_185044-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150306-linear-track/Mouse-2023-20150306_112849-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150326-linear-track/Mouse-2023-20150326_101329-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2023/Mouse-2023-20150316-linear-track/Mouse-2023-20150316_091246-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150316-linear-track/Mouse-2022-20150316_083627-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150306-linear-track/Mouse-2022-20150306_104914-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150227-linear-track/Mouse-2022-20150227_182234-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150228-linear-track/Mouse-2022-20150228_182558-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150228-linear-track/Mouse-2022-20150228_142050-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150321-linear-track/Mouse-2022-20150321_111200-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150331-linear-track/Mouse-2022-20150331_140317-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150311-linear-track/Mouse-2022-20150311_112532-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150329-linear-track/Mouse-2022-20150329_100439-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150326-linear-track/Mouse-2022-20150326_093722-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150301-linear-track/Mouse-2022-20150301_112611-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150301-linear-track/Mouse-2022-20150301_154837-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2022/Mouse-2022-20150327-linear-track/Mouse-2022-20150327_082741-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150307-linear-track/Mouse-2026-20150307_112614-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150331-linear-track/Mouse-2026-20150331_090237-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150323-linear-track/Mouse-2026-20150323_102333-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150327-linear-track/Mouse-2026-20150327_101915-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150329-linear-track/Mouse-2026-20150329_115639-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150319-linear-track/Mouse-2026-20150319_101913-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150325-linear-track/Mouse-2026-20150325_135422-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150305-linear-track/Mouse-2026-20150305_115921-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150311-linear-track/Mouse-2026-20150311_085602-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150303-linear-track/Mouse-2026-20150303_095846-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150309-linear-track/Mouse-2026-20150309_103302-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150315-linear-track/Mouse-2026-20150315_102127-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150321-linear-track/Mouse-2026-20150321_141554-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150313-linear-track/Mouse-2026-20150313_110801-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150301-linear-track/Mouse-2026-20150301_132603-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150301-linear-track/Mouse-2026-20150301_185053-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150228-linear-track/Mouse-2026-20150228_110319-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150228-linear-track/Mouse-2026-20150228_162802-linear-track-TracesAndEvents.mat',...
        '../linear_track/Mouse2026/Mouse-2026-20150317-linear-track/Mouse-2026-20150317_094553-linear-track-TracesAndEvents.mat'};
    session_mouse = {...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2025',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2012',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2010',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2028',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2019',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2011',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2029',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2024',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2021',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2023',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2022',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026',...
        'Mouse2026'};
    break;
end

num_sess = numel(sessions);
v_thresh = [0.5 1 1.5 2 2.5 3 3.5 4 4.5 5];
n_trials_found = zeros(num_sess, numel(v_thresh));
%%
for i = 172:num_sess
    load(sessions{i});
    track_coord = tracesEvents.position(:,1);
    opt = DecodeTensor.default_opt;
    
    for j = 1:numel(v_thresh)
        opt.v_thresh = v_thresh(j);
        [~, ~, tr_s, tr_e, tr_dir, tr_bins, ~] =...
            DecodeTensor.new_sel(track_coord, opt);
        n_trials_found(i, j) = numel(tr_s);
    end
end

%%
lookup = @(n) n_trials_found(find(strcmp(sessions, n),1), :);

lookup_cell = @(ns) cellfun(lookup, ns, 'UniformOutput', false);

%%
sheet_paths = {...
'../linear_track/Mouse2023/Mouse-2023-20150228-linear-track/Mouse-2023-20150228_144258-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150228-linear-track/Mouse-2023-20150228_185044-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150301-linear-track/Mouse-2023-20150301_114752-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150301-linear-track/Mouse-2023-20150301_162349-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150306-linear-track/Mouse-2023-20150306_112849-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150311-linear-track/Mouse-2023-20150311_124240-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150316-linear-track/Mouse-2023-20150316_091246-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150321-linear-track/Mouse-2023-20150321_114832-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150326-linear-track/Mouse-2023-20150326_101329-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2023/Mouse-2023-20150331-linear-track/Mouse-2023-20150331_144419-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150228-linear-track/Mouse-2024-20150228_153237-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150301-linear-track/Mouse-2024-20150301_124134-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150301-linear-track/Mouse-2024-20150301_173817-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150303-linear-track/Mouse-2024-20150303_082851-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150305-linear-track/Mouse-2024-20150305_104454-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150307-linear-track/Mouse-2024-20150307_100459-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150309-linear-track/Mouse-2024-20150309_090858&091446-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150311-linear-track/Mouse-2024-20150311_073912-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150313-linear-track/Mouse-2024-20150313_095203-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150315-linear-track/Mouse-2024-20150315_090450-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150317-linear-track/Mouse-2024-20150317_202708-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150319-linear-track/Mouse-2024-20150319_082641-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150321-linear-track/Mouse-2024-20150321_130536&130559-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150323-linear-track/Mouse-2024-20150323_082351-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150325-linear-track/Mouse-2024-20150325_114324-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150327-linear-track/Mouse-2024-20150327_090539-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150329-linear-track/Mouse-2024-20150329_104048-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2024/Mouse-2024-20150331-linear-track/Mouse-2024-20150331_101607-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150228-linear-track/Mouse-2028-20150228_114834-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150228-linear-track/Mouse-2028-20150228_172215-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150301-linear-track/Mouse-2028-20150301_141039-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150301-linear-track/Mouse-2028-20150301_192709-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150303-linear-track/Mouse-2028-20150303_103622-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150305-linear-track/Mouse-2028-20150305_132231-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150307-linear-track/Mouse-2028-20150307_120240-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150309-linear-track/Mouse-2028-20150309_110935-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150311-linear-track/Mouse-2028-20150311_093214-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150313-linear-track/Mouse-2028-20150313_114415-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150315-linear-track/Mouse-2028-20150315_105814-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150317-linear-track/Mouse-2028-20150317_102240-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150319-linear-track/Mouse-2028-20150319_105610-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150321-linear-track/Mouse-2028-20150321_144549-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150323-linear-track/Mouse-2028-20150323_105955-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150325-linear-track/Mouse-2028-20150325_143248-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150327-linear-track/Mouse-2028-20150327_105544-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2028/Mouse-2028-20150329-linear-track/Mouse-2028-20150329_133137-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141125-linear-track/Mouse-2010-20141125_000156-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141126-linear-track/Mouse-2010-20141126_111415-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141126-linear-track/Mouse-2010-20141126_151543-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141128-linear-track/Mouse-2010-20141128_121404-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141130-linear-track/Mouse-2010-20141130_115330-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141202-linear-track/Mouse-2010-20141202_110542-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141203-linear-track/Mouse-2010-20141203_103645-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141205-linear-track/Mouse-2010-20141205_102648-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141207-linear-track/Mouse-2010-20141207_115722-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141209-linear-track/Mouse-2010-20141209_101632-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141211-linear-track/Mouse-2010-20141211_140916-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141213-linear-track/Mouse-2010-20141213_115553-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141215-linear-track/Mouse-2010-20141215_125115-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141217-linear-track/Mouse-2010-20141217_120259-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141219-linear-track/Mouse-2010-20141219_105955-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141221-linear-track/Mouse-2010-20141221_113118&115136-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20141223-linear-track/Mouse-2010-20141223_094533-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150112-linear-track/Mouse-2010-20150112_103135-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150113-linear-track/Mouse-2010-20150113_160417-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150114-linear-track/Mouse-2010-20150114_152716-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150116-linear-track/Mouse-2010-20150116_113236-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150118-linear-track/Mouse-2010-20150118_112236-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150120-linear-track/Mouse-2010-20150120_095710-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150122-linear-track/Mouse-2010-20150122_093836-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150123-linear-track/Mouse-2010-20150123_150954-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150124-linear-track/Mouse-2010-20150124_111828-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150126-linear-track/Mouse-2010-20150126_094735-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150128-linear-track/Mouse-2010-20150128_111752-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150130-linear-track/Mouse-2010-20150130_094711-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150201-linear-track/Mouse-2010-20150201_111454-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150202-linear-track/Mouse-2010-20150202_101928-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150203-linear-track/Mouse-2010-20150203_103253-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150205-linear-track/Mouse-2010-20150205_102524-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150207-linear-track/Mouse-2010-20150207_114314-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150209-linear-track/Mouse-2010-20150209_100711-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150211-linear-track/Mouse-2010-20150211_160238-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2010/Mouse-2010-20150212-linear-track/Mouse-2010-20150212_094703-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141123-linear-track/Mouse-2012-20141123_000520-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141125-linear-track/Mouse-2012-20141125_030700-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141125-linear-track/Mouse-2012-20141125_215941-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141126-linear-track/Mouse-2012-20141126_085441-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141127-linear-track/Mouse-2012-20141127_101659-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141129-linear-track/Mouse-2012-20141129_100639-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141201-linear-track/Mouse-2012-20141201_083556-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141203-linear-track/Mouse-2012-20141203_084234-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141205-linear-track/Mouse-2012-20141205_083324-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141207-linear-track/Mouse-2012-20141207_100218-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141209-linear-track/Mouse-2012-20141209_082401-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141211-linear-track/Mouse-2012-20141211_121707-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141213-linear-track/Mouse-2012-20141213_100118-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141215-linear-track/Mouse-2012-20141215_110325-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141217-linear-track/Mouse-2012-20141217_104915-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141219-linear-track/Mouse-2012-20141219_094111-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141221-linear-track/Mouse-2012-20141221_095806-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20141223-linear-track/Mouse-2012-20141223_082741-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150112-linear-track/Mouse-2012-20150112_085723-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150113-linear-track/Mouse-2012-20150113_141832-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150114-linear-track/Mouse-2012-20150114_140933-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150116-linear-track/Mouse-2012-20150116_101239-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150118-linear-track/Mouse-2012-20150118_100831-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150118-linear-track/Mouse-2012-20150118_122056-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150120-linear-track/Mouse-2012-20150120_083419-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150122-linear-track/Mouse-2012-20150122_082416-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150123-linear-track/Mouse-2012-20150123_135330-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150124-linear-track/Mouse-2012-20150124_100435-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150126-linear-track/Mouse-2012-20150126_083013-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150128-linear-track/Mouse-2012-20150128_100143-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150128-linear-track/Mouse-2012-20150128_171615-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150130-linear-track/Mouse-2012-20150130_102501-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150201-linear-track/Mouse-2012-20150201_095905-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150202-linear-track/Mouse-2012-20150202_085844-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150203-linear-track/Mouse-2012-20150203_091636-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150205-linear-track/Mouse-2012-20150205_090558-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150207-linear-track/Mouse-2012-20150207_102450-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150207-linear-track/Mouse-2012-20150207_134254-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150209-linear-track/Mouse-2012-20150209_084856-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150211-linear-track/Mouse-2012-20150211_151241-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2012/Mouse-2012-20150212-linear-track/Mouse-2012-20150212_082737-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150228-linear-track/Mouse-2019-20150228_130909-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150228-linear-track/Mouse-2019-20150228_174527-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150301-linear-track/Mouse-2019-20150301_104001-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150301-linear-track/Mouse-2019-20150301_143437-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150306-linear-track/Mouse-2019-20150306_093422-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150311-linear-track/Mouse-2019-20150311_101049-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150316-linear-track/Mouse-2019-20150316_072301-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150321-linear-track/Mouse-2019-20150321_095525-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150326-linear-track/Mouse-2019-20150326_081710-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2019/Mouse-2019-20150331-linear-track/Mouse-2019-20150331_125138-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150316-linear-track/Mouse-2022-20150316_083627-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150306-linear-track/Mouse-2022-20150306_104914-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150227-linear-track/Mouse-2022-20150227_182234-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150228-linear-track/Mouse-2022-20150228_182558-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150228-linear-track/Mouse-2022-20150228_142050-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150321-linear-track/Mouse-2022-20150321_111200-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150331-linear-track/Mouse-2022-20150331_140317-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150311-linear-track/Mouse-2022-20150311_112532-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150329-linear-track/Mouse-2022-20150329_100439-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150326-linear-track/Mouse-2022-20150326_093722-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150301-linear-track/Mouse-2022-20150301_112611-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150301-linear-track/Mouse-2022-20150301_154837-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2022/Mouse-2022-20150327-linear-track/Mouse-2022-20150327_082741-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150307-linear-track/Mouse-2026-20150307_112614-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150331-linear-track/Mouse-2026-20150331_090237-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150323-linear-track/Mouse-2026-20150323_102333-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150327-linear-track/Mouse-2026-20150327_101915-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150329-linear-track/Mouse-2026-20150329_115639-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150319-linear-track/Mouse-2026-20150319_101913-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150325-linear-track/Mouse-2026-20150325_135422-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150305-linear-track/Mouse-2026-20150305_115921-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150311-linear-track/Mouse-2026-20150311_085602-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150303-linear-track/Mouse-2026-20150303_095846-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150309-linear-track/Mouse-2026-20150309_103302-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150315-linear-track/Mouse-2026-20150315_102127-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150321-linear-track/Mouse-2026-20150321_141554-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150313-linear-track/Mouse-2026-20150313_110801-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150301-linear-track/Mouse-2026-20150301_132603-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150301-linear-track/Mouse-2026-20150301_185053-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150228-linear-track/Mouse-2026-20150228_110319-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150228-linear-track/Mouse-2026-20150228_162802-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2026/Mouse-2026-20150317-linear-track/Mouse-2026-20150317_094553-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141123-linear-track/Mouse-2011-20141123_003522-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141125-linear-track/Mouse-2011-20141125_033559-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141125-linear-track/Mouse-2011-20141125_223115-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141126-linear-track/Mouse-2011-20141126_102932-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141126-linear-track/Mouse-2011-20141126_142057-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141127-linear-track/Mouse-2011-20141127_105556-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141129-linear-track/Mouse-2011-20141129_104511-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141201-linear-track/Mouse-2011-20141201_091423-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141203-linear-track/Mouse-2011-20141203_092044-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141207-linear-track/Mouse-2011-20141207_104116-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141209-linear-track/Mouse-2011-20141209_090137-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141211-linear-track/Mouse-2011-20141211_125424-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141213-linear-track/Mouse-2011-20141213_104253-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141215-linear-track/Mouse-2011-20141215_113956-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141217-linear-track/Mouse-2011-20141217_112712-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141219-linear-track/Mouse-2011-20141219_102235-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141221-linear-track/Mouse-2011-20141221_103622-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20141223-linear-track/Mouse-2011-20141223_090517-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150112-linear-track/Mouse-2011-20150112_094026-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150113-linear-track/Mouse-2011-20150113_150037-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150116-linear-track/Mouse-2011-20150116_105412-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150118-linear-track/Mouse-2011-20150118_104559-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150120-linear-track/Mouse-2011-20150120_091222-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150122-linear-track/Mouse-2011-20150122_090159-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150124-linear-track/Mouse-2011-20150124_104148-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150126-linear-track/Mouse-2011-20150126_091016-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150128-linear-track/Mouse-2011-20150128_103926-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150128-linear-track/Mouse-2011-20150128_175300-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150130-linear-track/Mouse-2011-20150130_091036-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150203-linear-track/Mouse-2011-20150203_095456-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150205-linear-track/Mouse-2011-20150205_094701-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150207-linear-track/Mouse-2011-20150207_110324-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150207-linear-track/Mouse-2011-20150207_142436-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150209-linear-track/Mouse-2011-20150209_092502-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150211-linear-track/Mouse-2011-20150211_163711-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2011/Mouse-2011-20150212-linear-track/Mouse-2011-20150212_090836-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150228-linear-track/Mouse-2021-20150228_180537-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150301-linear-track/Mouse-2021-20150301_110509-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150301-linear-track/Mouse-2021-20150301_151117-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150306-linear-track/Mouse-2021-20150306_101057-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150311-linear-track/Mouse-2021-20150311_104705-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150316-linear-track/Mouse-2021-20150316_075956-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150326-linear-track/Mouse-2021-20150326_085536-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2021/Mouse-2021-20150331-linear-track/Mouse-2021-20150331_132808-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150228-linear-track/Mouse-2025-20150228_160317-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150301-linear-track/Mouse-2025-20150301_130341-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150301-linear-track/Mouse-2025-20150301_181458-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150303-linear-track/Mouse-2025-20150303_091715-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150305-linear-track/Mouse-2025-20150305_112222-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150307-linear-track/Mouse-2025-20150307_104428-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150309-linear-track/Mouse-2025-20150309_095611-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150311-linear-track/Mouse-2025-20150311_081758-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150313-linear-track/Mouse-2025-20150313_103035-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150315-linear-track/Mouse-2025-20150315_094432-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150317-linear-track/Mouse-2025-20150317_090833-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150319-linear-track/Mouse-2025-20150319_090510-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150319-linear-track/Mouse-2025-20150319_095211-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150321-linear-track/Mouse-2025-20150321_134149-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150323-linear-track/Mouse-2025-20150323_090111-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150325-linear-track/Mouse-2025-20150325_131626-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150327-linear-track/Mouse-2025-20150327_094347-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150329-linear-track/Mouse-2025-20150329_111804-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2025/Mouse-2025-20150331-linear-track/Mouse-2025-20150331_082446-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150228-linear-track/Mouse-2029-20150228_120509-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150228-linear-track/Mouse-2029-20150228_150949-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150301-linear-track/Mouse-2029-20150301_121435-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150301-linear-track/Mouse-2029-20150301_165938-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150306-linear-track/Mouse-2029-20150306_121634-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150311-linear-track/Mouse-2029-20150311_131945-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150316-linear-track/Mouse-2029-20150316_094956-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150321-linear-track/Mouse-2029-20150321_122709-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150326-linear-track/Mouse-2029-20150326_105003-linear-track-TracesAndEvents.mat',...
'../linear_track/Mouse2029/Mouse-2029-20150331-linear-track/Mouse-2029-20150331_152034-linear-track-TracesAndEvents.mat'};


%% panel A: decorrelation result for Mouse2022/21/24

%creating figure 1
svg_save_dir = 'supplements_svg';
print_svg = @(name) print('-dsvg', fullfile(svg_save_dir, [name '.svg']));
%%
% Caption: Inverse mean squared error for a neural decoder for place as a
% function of number of cells included in the decoder. Aggregated over 20
% random cell subsets of fixed size, shown for one mouse. 
% Shaded regions represent 95% confidence range.
% Trial shuffled data does not reach a performance saturation at 500 neurons, whereas
% unshuffled data does.
name = 'DataSeries';
figure;

dbfile = 'decoding.db';

conn = sqlite(dbfile); %remember to close it
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'shuffled', 'NumNeurons', 'IMSE', 'max');
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'unshuffled', 'NumNeurons', 'IMSE', 'max');
mouse_list = {'Mouse2022', 'Mouse2019', 'Mouse2028'};
for m_i = 1:numel(mouse_list)
    mouse = mouse_list{m_i};
    disp(mouse);
    [n,m,e] = DecodingPlotGenerator.get_errors('DataSize', conn, mouse, 'unshuffled', 'IMSE', 'max');
    [ns,ms,es] = DecodingPlotGenerator.get_errors('DataSize', conn, mouse, 'shuffled', 'IMSE', 'max');
    hold on;
    DecodingPlotGenerator.errors_plotter(ns,ms,es, 'shuffled');
    DecodingPlotGenerator.errors_plotter(n,m,e, 'unshuffled');
end
xlabel 'Number of trials'
ylabel '1/MSE (cm^{-2})'
xlim([0 200]);
text(100, 0.325/5.9, 'Unshuffled', 'Color', 'blue');
text(15, 0.8/5.9, 'Shuffled', 'Color', 'red');
figure_format;

print_svg(name);
%print('-dsvg', fullfile(svg_save_dir, 'A.svg'));
%print('-dpng', '-r900', fullfile(svg_save_dir, 'A.png'));
%body
conn.close;

%%

name = 'DataSize_controlled';
figure;

dbfile = 'decoding.db';

conn = sqlite(dbfile); %remember to close it
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'shuffled', 'NumNeurons', 'IMSE', 'max');
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'unshuffled', 'NumNeurons', 'IMSE', 'max');
mouse_list = {'Mouse2022', 'Mouse2019', 'Mouse2028'};
for m_i = 1:numel(mouse_list)
    mouse = mouse_list{m_i};
    disp(mouse);
    [n,m,e] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'unshuffled', 'IMSE', 156);
    [ns,ms,es] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'shuffled', 'IMSE', 156);
    hold on;
    DecodingPlotGenerator.errors_plotter(ns,ms,es, 'shuffled');
    DecodingPlotGenerator.errors_plotter(n,m,e, 'unshuffled');
end
xlabel 'Number of cells'
ylabel '1/MSE (cm^{-2})'
xlim([0 500]);
text(200+50, 0.3/5.9, 'Unshuffled', 'Color', 'blue');
text(55, 0.8/5.9, 'Shuffled', 'Color', 'red');
figure_format;

print_svg(name);
%print('-dsvg', fullfile(svg_save_dir, 'A.svg'));
%print('-dpng', '-r900', fullfile(svg_save_dir, 'A.png'));
%body
conn.close;

%%
name = 'DataSize_uncontrolled';
figure;

dbfile = 'decoding.db';

conn = sqlite(dbfile); %remember to close it
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'shuffled', 'NumNeurons', 'IMSE', 'max');
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'unshuffled', 'NumNeurons', 'IMSE', 'max');
mouse_list = {'Mouse2022', 'Mouse2019', 'Mouse2028'};
for m_i = 1:numel(mouse_list)
    mouse = mouse_list{m_i};
    disp(mouse);
    [n,m,e] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'unshuffled', 'IMSE', 'max');
    [ns,ms,es] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'shuffled', 'IMSE', 'max');
    hold on;
    DecodingPlotGenerator.errors_plotter(ns,ms,es, 'shuffled');
    DecodingPlotGenerator.errors_plotter(n,m,e, 'unshuffled');
end
xlabel 'Number of cells'
ylabel '1/MSE (cm^{-2})'
xlim([0 500]);
text(200+50, 0.3/5.9, 'Unshuffled', 'Color', 'blue');
text(55, 0.8/5.9, 'Shuffled', 'Color', 'red');
figure_format;

print_svg(name);
%print('-dsvg', fullfile(svg_save_dir, 'A.svg'));
%print('-dpng', '-r900', fullfile(svg_save_dir, 'A.png'));
%body
conn.close;

%% do simple decode with raw_traces and spikeDeconv, on 3-4 mice
% for i = 1:12
%     D_T = DecodeTensor(i, 'rawTraces');
%     
%     [mean_err, MSE(i), ps, ks, ~] = D_T.basic_decode(false, [], []);
%     [mean_err_s, MSE_s(i), ps_s, ks_s, ~] = D_T.basic_decode(true, [], []);
%     
%     
%     D_T_spike = DecodeTensor(i, 'spikeDeconv');
%     
%     [mean_err, MSE_spike(i), ps, ks, ~] = D_T_spike.basic_decode(false, [], []);
%     [mean_err_s, MSE_spike_s(i), ps_s, ks_s, ~] = D_T_spike.basic_decode(true, [], []);
%     
%     %ps = ceil(ps/2);
%     %ks = ceil(ks/2);
%     %ps_s = ceil(ps_s/2);
%     %ks_s = ceil(ks_s/2);
%     
%     %num_trials(i) = 2*D_T.n_one_dir_trials;
%     %C = confusionmat(ks, ps); %./ (2*D_T.n_one_dir_trials);
%     %C_s = confusionmat(ks_s, ps_s);% ./ (2*D_T.n_one_dir_trials);
%     %C_perfect = confusionmat(ks_s, ks);% ./ (2*D_T.n_one_dir_trials);
%     %CDiff(:,:,i) = C_s - C;
%     %CsC = (C_s - C)./C;
%     %CsC(isnan(CsC)) = 0;
%     disp(i);
% end
% %% plot for above
% imse = 1./MSE; imse_spike = 1./MSE_spike;
% imse_s = 1./MSE_s; imse_spike_s = 1./MSE_spike_s;
% 
% num_neurons = [182 202 304 497 239 422 272 257 197 451 210 441];
% 
% shuf_diff = (1 - imse./imse_s) .* num_neurons;
% shuf_diff_spike = (1 - imse_spike./imse_spike_s) .* num_neurons;
% 
% figure;
% boxplot([shuf_diff.' , shuf_diff_spike.'], {'Traces', 'OASIS detected'});
%% Decoding from padded events
name = 'Decoding_from_padded_events';
figure;

dbfile = 'padded_events_decoding.db';

conn = sqlite(dbfile); %remember to close it
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'shuffled', 'NumNeurons', 'IMSE', 'max');
%DecodingPlotGenerator.plot_mice(conn, {'Mouse2022'}, 'unshuffled', 'NumNeurons', 'IMSE', 'max');
mouse_list = {'Mouse2022'};%, 'Mouse2019', 'Mouse2028'};
for m_i = 1:numel(mouse_list)
    mouse = mouse_list{m_i};
    disp(mouse);
    [n,m,e] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'unshuffled', 'IMSE', 'max');
    [ns,ms,es] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'shuffled', 'IMSE', 'max');
    hold on;
    DecodingPlotGenerator.errors_plotter(ns,ms,es, 'shuffled');
    DecodingPlotGenerator.errors_plotter(n,m,e, 'unshuffled');
end
xlabel 'Number of cells'
ylabel '1/MSE (cm^{-2})'
xlim([0 500]);
text(200+50, 0.3/5.9/27, 'Unshuffled', 'Color', 'blue');
text(55, 0.8/5.9/20, 'Shuffled', 'Color', 'red');
figure_format;

print_svg(name);
%print('-dsvg', fullfile(svg_save_dir, 'A.svg'));
%print('-dpng', '-r900', fullfile(svg_save_dir, 'A.png'));
%body
conn.close;

%%  panel: full vs diagonal decoder on one mouse (from padded events):
name = 'Decoding_from_padded_events_fulldiagonal';
figure;

dbfile = 'padded_events_decoding.db';

conn = sqlite(dbfile); %remember to close it
mouse_list = {'Mouse2022'};%, 'Mouse2024', 'Mouse2028'};
for m_i = 1:numel(mouse_list)
    mouse = mouse_list{m_i};
    [n,m,e] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'unshuffled', 'IMSE', 'max');
    [ns,ms,es] = DecodingPlotGenerator.get_errors('NumNeurons', conn, mouse, 'diagonal', 'IMSE', 'max');
    hold on;
    DecodingPlotGenerator.errors_plotter(ns,ms*1e4,es*1e4, 'diagonal');
    DecodingPlotGenerator.errors_plotter(n,m*1e4,e*1e4, 'unshuffled');
end
xlabel 'Number of cells'
%ylabel '1/MSE (cm^{-2})'
ylabel '1/MSE (m^{-2})'
xlim([0 500]);
text(300, 0.18/5.9/15*1e4, 'Full', 'Color', 'blue');
text(150+130, 0.1/5.9/15*1e4, 'Diagonal', 'Color', 'magenta');
figure_format;


print_svg(name);
conn.close;

%% events padding length vs. decoding accuracy
pad_second_values = [0 0.25 0.4 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1 1.5 2];
%pad_second_values = (0:5:60)/20;
n_reps = 20;
%mean_err_pad = zeros(n_reps, numel(pad_second_values));
%MSE_pad = mean_err_pad;
%ps_pad = cell(n_reps, numel(pad_second_values));
%ks_pad = ps_pad;
for rep = 1:n_reps
    parfor i_p = 1:numel(pad_second_values)
        opt = DecodeTensor.default_opt;
        opt.neural_data_type = 'FST_padded';
        opt.pad_seconds = pad_second_values(i_p);
        D_T = DecodeTensor(4, 'fake', opt);
        my_timing = tic;
        [mean_err_pad(rep, i_p), MSE_pad(rep, i_p), ps_pad{rep,i_p}, ks_pad{rep,i_p}, ~] = D_T.basic_decode(false, [], []);
        fprintf('%d (s):: Unshuffled decoding with %.2f padding: m_e: %.2f\tMSE: %.2f\n',...
            round(toc(my_timing)), opt.pad_seconds, mean_err_pad(rep, i_p), MSE_pad(rep, i_p));
    end
end
save(sprintf('ideal_pad_%s.mat', timestring), 'mean_err_pad', 'MSE_pad', 'ps_pad', 'ks_pad', 'pad_second_values');
%%
figure; shadedErrorBar(pad_second_values, mean(1./MSE_pad), std(1./MSE_pad)./sqrt(n_reps));
xlabel 'Padding duration (s)'
ylabel '1/MSE (cm^{-2})'
text(0.38, 0.003, '0.8s');
figure_format;
hold on; l_ = line([0.8 0.8], ylim); l_.Color = 'k';
print_svg('optimal_padding');